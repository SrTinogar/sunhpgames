%%HP: T(3)A(D)F(.);
"
%*********************
%* TENNIS by SunHP   *
%*       v1.0        *
%*********************

!OFF
GOSBVL 0679B
GOSBVL 01115
CLRST
GOSUBL INI

*LCD2
GOSUBL CAF
GOSUBL RG
GOSUBL RD
GOSUBL \->LCD
GOSUBL LOVE

*LCD1
GOSUBL CAF
GOSUBL AF
GOSUBL RG
GOSUBL RD
GOSUBL FIL
GOSUBL \->LCD
GOSUBL O
GOSUBL V
GOSUBL O
GOSUBL V
GOSUBL FILET
GOSUBL TLD
GOSUBL TLG
GOSUBL THG
GOSUBL TBG
GOSUBL THD
GOSUBL TBD
GOSUBL THG
GOSUBL TBG
GOSUBL THD
GOSUBL TBD
GOSUBL TVG
GOSUBL TVD
GOSUBL TQ
GOLONG LCD1

*TQ
LA 010
C=A X
GOSBVL 01EEC
C=C&A X
?C\=/0 X
GOYES Q
RTN
*Q
D0= 0010C
A=DAT0 A
ABIT=1 3
DAT0=A A
D0= 00128
LC 37
DAT0=C B
D0= 8068D
A=DAT0 A
D0= 00120
DAT0=A A
GOSBVL 067D2
A=DAT0 A
D0=D0+ 5
PC=(A)

*AF
GOSUB BAL
$E0519111E0E03171F1E0C1A22322C1C162E2E3C1834546448383C4C5C783078A8C880707898B8F07
*BAL
C=RSTK
?ST=1 0
GOYES B1
?ST=1 1
GOYES B2
?ST=1 2
GOYES B3
GOTO B4
*B1
GOTO NAF
*B2
C=C+10 A
C=C+10 A
GOTO NAF
*B3
C=C+10 A
C=C+10 A
C=C+10 A
C=C+10 A
GOTO NAF
*B4
C=C+10 A
C=C+10 A
C=C+10 A
C=C+10 A
C=C+10 A
C=C+10 A
GOTO NAF
*NAF
D1=C
A=R0
D0=A
LC 04
B=C B
*AFB
A=DAT1 B
C=DAT0 B
A=A!C B
DAT0=A B
GOSUBL 34
D1=D1+ 2
B=B-1 B
GONC AFB
A=R0
LC 00880
A=A+C A
D0=A
LC 04
B=C B
*AFB2
A=DAT1 B
C=DAT0 B
A=A!C B
DAT0=A B
GOSUBL 34
D1=D1+ 2
B=B-1 B
GONC AFB2
RTN

*O
?ST=0 5
GOYES D
GOLONG G
*D
D0= 8010A
A=DAT0 B
LC 7E
?A\=/C B
GOYES NLD
GOLONG LD
RTN
*NLD
A=A+1 B
DAT0=A B
?ST=1 0
GOYES D1
?ST=1 1
GOYES D2
?ST=1 2
GOYES D3
GOTO D4
*D1
ST=0 0
ST=1 1
RTN
*D2
ST=0 1
ST=1 2
RTN
*D3
ST=0 2
ST=1 3
RTN
*D4
ST=0 3
ST=1 0
A=R0
A=A+1 A
R0=A
RTN
*G
D0= 8010A
A=DAT0 B
?A\=/0 B
GOYES NLG
GOLONG LG
RTN
*NLG
A=A-1 B
DAT0=A B
?ST=1 0
GOYES G1
?ST=1 1
GOYES G2
?ST=1 2
GOYES G3
GOTO G4
*G1
ST=0 0
ST=1 3
A=R0
A=A-1 A
R0=A
RTN
*G2
ST=0 1
ST=1 0
RTN
*G3
ST=0 2
ST=1 1
RTN
*G4
ST=0 3
ST=1 2
RTN
*V
?ST=0 4
GOYES B
GOLONG H
*B
D0= 8010C
A=DAT0 B
LC 3B
?A\=/C B
GOYES NLB
ST=1 4
RTN
*NLB
A=A+1 B
DAT0=A B
A=R0
LC 00022
A=A+C A
R0=A
RTN
*H
D0= 8010C
A=DAT0 B
?A\=/0 B
GOYES NLH
ST=0 4
RTN
*NLH
A=A-1 B
DAT0=A B
A=R0
LC 00022
A=A-C A
R0=A
RTN
*INI
C=0 B
D0= 80112
DAT0=C B
D0= 80114
DAT0=C B
LC 3F
D0= 00128
DAT0=C B
D0= 0010C
A=DAT0 A
ABIT=0 3
DAT0=A A

LC 02200
GOSBVL 05B7D
AD0EX
A=A+1 A
ABIT=0 0

LC 00088
A=A+C A

D0= 80100
DAT0=A A
LC 00880
A=A+C A
D0= 80105
DAT0=A A
A=A+C A
D0= 80118
DAT0=A A

D0= 80100
A=DAT0 A
D0=A
LC D7F
A=0 B
*CL
DAT0=A B
D0=D0+ 2
C=C-1 X
GONC CL

D0= 80100
A=DAT0 A
D0= 00120
DAT0=A A

C=0 B
D0= 80116
DAT0=C B
D0= 80105
A=DAT0 A
A=A+16 A
R4=A

*REPLAY
ST=1 0
D0= 80105
A=DAT0 A
R0=A
D0= 8010A
C=0 B
DAT0=C B
D0= 8010C
DAT0=C B
D0= 80105
A=DAT0 A
LC 00396
A=A+C A
R1=A
A=A+16 A
A=A+16 A
R2=A
D0= 8010E
LC 1B
DAT0=C B
D0= 80110
DAT0=C B
D0= 80118
C=0 B
DAT0=C B
D0= 8011A
DAT0=C B
RTN

*CAF
D0= 80105
A=DAT0 A
D0=A
LC 87
A=0 W
*CLAF
DAT0=A W
D0=D0+ 16
C=C-1 B
GONC CLAF
GOSUBL SOL
$FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF701000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810008B53F000000060000000401000000810008A65F000000060000000401000000810000BE3F000000060000000401000000810008F61F000000060000000401000000810000000F0000000600000004070000008FFFFFFFFFFFFFFFF70000000701000000810000000F000000060000000401000000810000000FE6D000060000000401000000810000000FAA5100060000000401000000810000000FCAF000060000000401000000810000000FEB5000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F000000060000000401000000810000000F00000006000000040FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70
*SOL
C=RSTK
D1=C
LC 87
*CLAF2
A=DAT1 W
DAT0=A W
D0=D0+ 16
D1=D1+ 16
C=C-1 B
GONC CLAF2
RTN

*\->LCD
D0= 80105
A=DAT0 A
R3=A
GOSUBL GREY
RTN
*RG
GOSUB FX
D1=C
A=R1
D0=A
LC 09
B=C B
*ARG
A=DAT1 1
C=DAT0 1
A=A!C B
DAT0=A 1
GOSUBL 34
D1=D1+ 2
B=B-1 B
GONC ARG
A=R1
LC 00880
A=A+C A
D0=A
LC 09
B=C B
*ARG2
A=DAT1 1
C=DAT0 1
A=A!C B
DAT0=A 1
GOSUBL 34
D1=D1+ 2
B=B-1 B
GONC ARG2
RTN

*RD
GOSUB FX
C=C+16 A
C=C+4 A
C=C+16 A
C=C+4 A
D1=C
A=R2
D0=A
LC 09
*ARD
A=DAT1 1
DAT0=A 1
GOSUBL 34
D1=D1+ 2
C=C-1 B
GONC ARD
A=R2
LC 00880
A=A+C A
D0=A
LC 09
*ARD2
A=DAT1 1
DAT0=A 1
GOSUBL 34
D1=D1+ 2
C=C-1 B
GONC ARD2
RTN

*FX
GOSUB RQ
$60A0A0E0E0A0A0E0E06060A0A0A0A0E0E0E0E0606070705050707050506060707070705050505060
*RQ
C=RSTK
RTN

*THG
LA 010
LC 004
GOSBVL 01EEC
C=C&A X
?C\=/0 X
GOYES YHG
RTN

*YHG
D0= 8010E
A=DAT0 B
?A\=/0 B
GOYES NLHG
RTN

*NLHG
A=A-1 B
DAT0=A B
A=R1
LC 00022
A=A-C A
R1=A
RTN

*TBG
LA 010
LC 008
GOSBVL 01EEC
C=C&A X
?C\=/0 X
GOYES YBG
RTN

*YBG
D0= 8010E
A=DAT0 B
LC 36
?A\=/C B
GOYES NLBG
RTN

*NLBG
A=A+1 B
DAT0=A B
A=R1
LC 00022
A=A+C A
R1=A
RTN

*THD
LA 001
LC 080
GOSBVL 01EEC
C=C&A X
?C\=/0 X
GOYES YHD
RTN

*YHD
D0= 80110
A=DAT0 B
?A\=/0 B
GOYES NLHD
RTN

*NLHD
A=A-1 B
DAT0=A B
A=R2
LC 00022
A=A-C A
R2=A
RTN

*TBD
LA 001
LC 020
GOSBVL 01EEC
C=C&A X
?C\=/0 X
GOYES YBD
RTN

*YBD
D0= 80110
A=DAT0 B
LC 36
?A\=/C B
GOYES NLBD
RTN

*NLBD
A=A+1 B
DAT0=A B
A=R2
LC 00022
A=A+C A
R2=A
RTN

*TLD
A=R0
A=A+2 A
D0=A
LC 04
*TMD
A=DAT0 B
?ABIT=1 0
GOYES YMD
GOSUBL 34
C=C-1 B
GONC TMD
RTN

*YMD
?ST=1 5
GOYES DEJ1
ST=1 5
GOSUBL CLAC
*DEJ1
RTN

*TLG
A=R0
A=A-1 A
D0=A
LC 04
*TMG
A=DAT0 B
?ABIT=1 3
GOYES YMG
GOSUBL 34
C=C-1 B
GONC TMG
RTN

*YMG
?ST=0 5
GOYES DEJ2
ST=0 5
GOSUBL CLAC
*DEJ2
RTN

*LD
GOSUBL HI
D0= 80112
A=DAT0 B
A=A+1 B
DAT0=A B
GOLONG COMPTEUR
*LG
GOSUBL HI
D0= 80114
A=DAT0 B
A=A+1 B
DAT0=A B
GOLONG COMPTEUR

*COMPTEUR
D0= 80112
A=DAT0 B
LC 0A
?A\=/C B
GOYES NQQ
GOLONG Q

*NQQ
D0= 80114
A=DAT0 B
LC 0A
?A\=/C B
GOYES NQQ2
GOLONG Q
*NQQ2
GOSUBL FX2
D1=C
D0= 80112
A=0 W
C=0 B
*TC1
A=DAT0 B
?A=C B
GOYES AF1
C=C+1 B
D1=D1+ 2
GOTO TC1
*AF1
D0= 80105
A=DAT0 A
LC 00220
A=A+C A
A=A+4 A
D0=A
LC 06
*AFF1
A=DAT1 B
DAT0=A B
GOSUBL 34
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
C=C-1 B
GONC AFF1
GOSUBL FX2
D1=C
D0= 80114
A=0 W
C=0 B
*TC2
A=DAT0 B
?A=C B
GOYES AF2
C=C+1 B
D1=D1+ 2
GOTO TC2
*AF2
D0= 80105
A=DAT0 A
A=A+16 A
A=A+12 A
LC 00220
A=A+C A
D0=A
LC 06
*AFF2
A=DAT1 B
DAT0=A B
GOSUBL 34
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
C=C-1 B
GONC AFF2
LC 00020
B=C A
*WW
GOSUBL GREY
LC 00880
*WWW
C=C-1 A
GONC WWW
B=B-1 A
GONC WW
CLRST
GOSUBL REPLAY
RTN

*FX2
GOSUB NBR
$E0C0C1C101E381E3C1C10000000000000091E0E3E38160C10323E300000000000000D1C02303C1E16081232300000000000000B1C081C1A103E1C0C1C30000000000000091C0C003E30323C0230300000000000000F1E1E3E381E3E3C0E3E300000000000000E0E1E3C181C1C1C0C1C100000000000000
*NBR
C=RSTK
RTN
*CLAC
A=0 W
C=0 W
A=B W
C=D W
AD0EX
CD1EX
A=0 W
C=0 W
LC 5
B=C A
D=C A
LA 3
C=0 W
*SN1..
C=0 W
OUT=C
LC 800
OUT=C
C=0 W
OUT=C
LC 800
OUT=C
*AT1..
B=B-1 A
GONC AT1..
B=0 W
C=0 W
C=D A
B=C A
D=D-1 A
C=0 W
A=A-1 A
GONC SN1..
A=0 W
C=0 W
LC 20
B=C A
D=C A
LA 5
C=0 W
*SN2..
C=0 W
OUT=C
LC 800
OUT=C
C=0 W
OUT=C
*AT2..
B=B-1 A
GONC AT2..
B=0 W
C=0 W
C=D A
B=C A
D=D+1 A
C=0 W
A=A-1 A
GONC SN2..
A=0 W
C=0 W
AD0EX
CD1EX
B=A W
D=C W
A=0 W
C=0 W
RTN

*HI
A=0 W
C=0 W
A=B W
C=D W
AD0EX
CD1EX
A=0 W
C=0 W
LC 90
B=C A
D=C A
LA 80
C=0 W
*SN7.
C=0 W
OUT=C
LC 800
OUT=C
C=0 W
OUT=C
LC 800
OUT=C
*AT7.
B=B-1 A
GONC AT7.
B=0 W
C=0 W
C=D A
B=C A
D=D-1 A
C=0 W
A=A-1 A
GONC SN7.
A=0 W
C=0 W
LC 50
B=C A
D=C A
LA 30
C=0 W
*SN8.
C=0 W
OUT=C
LC 800
OUT=C
C=0 W
OUT=C
*AT8.
B=B-1 A
GONC AT8.
B=0 W
C=0 W
C=D A
B=C A
D=D+1 A
C=0 W
A=A-1 A
GONC SN8.
A=0 W
C=0 W
AD0EX
CD1EX
B=A W
D=C W
A=0 W
C=0 W
RTN

*GREY
A=0 W
D0= 00128
*L3
A=DAT0 6
?A=0 W
GOYES Y3
GOTO L3
*Y3
C=R3
GOSUBL AFI
D0= 00128
*L1
A=DAT0 6
?A=0 W
GOYES Y1
GOTO L1
*Y1
C=R3
LA 00880
C=C+A A
GOSUBL AFI
RTN

*AFI
A=0 W
D1=C
D0= 80100
A=DAT0 A
D0=A
LC 87
*LZ
A=DAT1 W
DAT0=A W
D0=D0+ 16
D1=D1+ 16
C=C-1 B
GONC LZ
A=0 W
RTN

*34
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
RTN

*FIL
A=R4
D0=A
LC 04
LA FF
*AFL
DAT0=A 1
GOSUBL 34
C=C-1 B
GONC AFL
RTN
*FILET
?ST=0 6
GOYES BFL
GOTO HFL
*BFL
D0= 80116
A=DAT0 B
LC 39
?A\=/C B
GOYES NLBFL
ST=1 6
RTN
*NLBFL
A=A+1 B
DAT0=A B
A=R4
LC 00022
A=A+C A
R4=A
RTN

*HFL
D0= 80116
A=DAT0 B
?A\=/0 B
GOYES NLHFL
ST=0 6
RTN

*NLHFL
A=A-1 B
DAT0=A B
A=R4
LC 00022
A=A-C A
R4=A
RTN

*TVG
LA 010
LC 040
GOSBVL 01EEC
C=C&A X
?C\=/0 X
GOYES YVG
GOLONG NVG
*YVG
D0= 80118
A=DAT0 B
LC 0F
?A\=/C B
GOYES NLVG
RTN

*NLVG
A=A+1 B
DAT0=A B
A=R1
A=A+1 A
R1=A
RTN

*NVG
D0= 80118
A=DAT0 B
?A\=/0 B
GOYES NLNVG
RTN
*NLNVG
A=A-1 B
DAT0=A B
A=R1
A=A-1 A
R1=A
RTN

*TVD
LA 002
LC 040
GOSBVL 01EEC
C=C&A X
?C\=/0 X
GOYES YVD
GOLONG NVD
*YVD
D0= 8011A
A=DAT0 B
LC 0F
?A\=/C B
GOYES NLVD
RTN
*NLVD
A=A+1 B
DAT0=A B
A=R2
A=A-1 A
R2=A
RTN
*NVD
D0= 8011A
A=DAT0 B
?A\=/0 B
GOYES NLNVD
RTN
*NLNVD
A=A-1 B
DAT0=A B
A=R2
A=A+1 A
R2=A
RTN

*LOVE
*W1
GOSUBL GREY
LC 00880
*WWW2
C=C-1 A
GONC WWW2
C=0 W
GOSBVL 00E0B
?C\=/0 X
GOYES W1
*W2
GOSUBL GREY
LC 00880
*WWW3
C=C-1 A
GONC WWW3
C=0 W
GOSBVL 00E0B
?C=0 X
GOYES W2
RTN

@"