HPHP48-R,*∞I
D1= 80500
A=DAT1 A
A=A+15 A
A=A+5 A
LC 00840
A=A+C A
A=A+3 A
R2=A
%A=A-3 A
A=A+1 A
R4=A
GOSUBL INI
GOSUBL P1
GOSUBL P1.2
GOSUBL INI2

*LCD1
GOSUBL DECOR1
GOSUBL DECOR2

GOSUBL WAIT1
GOSUBL WAIT2

ST=0 7
GOSUBL çCAR
C=ST
D0= 8011A
DAT0=C X
D0= 8011D
C=DAT0 X
ST=C
ST=1 7
GOSUBL çCAR
ST=0 7
D0= 8011D
C=ST
DAT0=C X
D0= 8011A
C=DAT0 X
ST=C
GOSUBL çLCD

GOSUBL çEC
GOSUBL TQ
GOLONG LCD1

%subs. progs:

*WAIT1
D0= 80132
A=DAT0 A
?A=0 A
GOYES ACTION
A=A-1 A
DAT0=A A
GOTO SUITE
*ACTION
GOLONG çAC1
*RETOUR1
D0= 80128
A=DAT0 A
D0= 80132
DAT0=A A

*SUITE
RTN

*WAIT2
D0= 80137
A=DAT0 A
?A=0 A
GOYES ACTION2
A=A-1 A
DAT0=A A
GOTO SUITE2
*ACTION2
GOLONG çAC2
*RETOUR2
D0= 8012D
A=DAT0 A
D0= 80137
DAT0=A A

*SUITE2
RTN


*TQ
LA 001
LC 010
OUT=C
GOSBVL 01160
C=C&A X
?Cã0 X
GOYES QUIT
RTN
*QUIT
CLRST
D0= 8068D
A=DAT0 A
D0= 00120
DAT0=A A
GOSUBL STOKEY.INI
GOLONG MAIN

*INI
D0= 80100
A=DAT0 A
D0=A
LC CBF
A=0 B
*AAA
DAT0=A B
D0=D0+ 2
C=C-1 X
GONC AAA
C=0 X
D0= 80100
A=DAT0 A
LC 00880
A=A+C A
A=A+C A
LC 00440
A=A+C A
A=A+4 A
R0=A
A=A+16 A
A=A+2 A
R3=A
A=A-C A
A=A-6 A
A=A-16 A
LC 00880
A=A-C A
A=A-C A
D0= 00120
DAT0=A A
RTN

*INI2
D0= 80105
C=0 W
LC 20
DAT0=C B
D0=D0+ 2
LC 0F
DAT0=C B
C=0 W
D0= 8010A
CBIT=1 0
DAT0=C 4
D0= 80116
DAT0=C 4
LC 00010
D0= 80128
DAT0=C A
D0= 8012D
DAT0=C A
D0= 80132
DAT0=C A
D0= 80137
DAT0=C A

R1=C
C=0 W
D0= 8010E
DAT0=C 4
LC 06
DAT0=C B
D0=D0+ 2
LC 06
DAT0=C B
C=0 W
D0= 8013C
DAT0=C 4
LC 06
DAT0=C B
D0=D0+ 2
LC 06
DAT0=C B
C=0 W

D0= 80112
C=0 W

DAT0=C B
D0=D0+ 2
DAT0=C B

C=0 W
D0= 8011A
DAT0=C 6
C=0 W
D0= 80120
LC 20
DAT0=C B
D0=D0+ 2
LC 16
DAT0=C B
C=0 W
D0= 80124
DAT0=C 4
%


RTN

*TT
LA 008
LC 001
OUT=C
GOSBVL 01160
C=C&A X
?Cã0 X
GOYES GO
C=R1
LA 00010
?CäA A
GOYES STOP
LA 00001
C=C+A A
R1=C
GOTO FOND
*STOP
D0= 80110
LC 01
DAT0=C B
RTN
*GO
C=R1
LA 00001
?C<A A
GOYES FOND
LA 00001
C=C-A A
R1=C
D0= 80110
GOSUBL GREEN
GOTO NXTA
*FOND
D0= 80110
LC 03
DAT0=C B
*NXTA
GOSUBL AVANCE
RTN
*TT2
LA 002
LC 001
OUT=C
GOSBVL 01160
C=C&A X
?Cã0 X
GOYES GO.2
C=R1
LA 00010
?CäA A
GOYES STOP.2
LA 00001
C=C+A A
R1=C
GOTO FOND.2
*STOP.2
D0= 8013E
LC 01
DAT0=C B
RTN
*GO.2
C=R1
LA 00001
?C<A A
GOYES FOND.2
LA 00001
C=C-A A
R1=C
D0= 8013E
GOSUBL GREEN
GOTO NXTA

*FOND.2
D0= 8013E
LC 03
DAT0=C B
*NXTA.2
GOSUBL AVANCE
RTN

*çEC
D0= 80100
A=DAT0 A
LC 00880
A=A+C A
D0=A
A=A+C A
D1=A
LC 87
B=C B
*AAM
A=DAT0 W
DAT1=A W
D0=D0+ 16
D1=D1+ 16
B=B-1 B
GONC AAM
B=0 B
RTN
*SCROLL
D0= 80100
A=DAT0 A
D0=A
LC 87
*AAE
A=DAT0 W
A=A+A W
DAT0=A W
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 B
GONC AAE
C=0 B
RTN

*çCAR
GOSUB $T
$810042006600E700C300C300E700E700C30003008400CC00CF008700C300E700E700C30000008600C900AB00F700EF00E500C3000100000006006F00F310F310FF00F6006000000000006600FF00F310F310FF0066000000000000006000F600FF00F310F3106F00060000000100C300E500EF00F700AB00C90086000000C300E700E700C3008700CF00CC0084000300C300E700E700C300C300E7006600420081008700CF00CF008700C300E700660042008100010087004F00EF00CF10AB002700C200000000000C00CE10EF109F109F10ED00C00000000000CC00EF109F109F10EF10CC00000000000000C000ED009F109F10EF10CE100C0000000000C2002700AB00CF10EF004F0087000100810042006600E700C3008700CF00CF008700000000000000000000000000
*$T
C=RSTK
D1=C
?ST=1 7
GOYES JR2.2
D0= 8010A
GOTO XJR.2
*JR2.2
D0= 80116
*XJR.2
C=DAT0 A
?ST=1 7
GOYES JR2
A=R0
GOTO XJR
*JR2
A=R3
*XJR
D0=A
?CBIT=1 0
GOYES C1
?CBIT=1 1
GOYES C2
?CBIT=1 2
GOYES C3
?CBIT=1 3
GOYES C4
?CBIT=1 4
GOYES C5
?CBIT=1 5
GOYES C6
?CBIT=1 6
GOYES C7
?CBIT=1 7
GOYES C8
?CBIT=1 8
GOYES C9
?CBIT=1 9
GOYES C10
?CBIT=1 10
GOYES C11
?CBIT=1 11
GOYES C12
?CBIT=1 12
GOYES C13
?CBIT=1 13
GOYES C14
?CBIT=1 14
GOYES C15
?CBIT=1 15
GOYES C16

*C1
GOLONG A1
*C2
GOLONG A2
*C3
GOLONG A3
*C4
GOLONG A4
*C5
GOLONG A5
*C6
GOLONG A6
*C7
GOLONG A7
*C8
GOLONG A8
*C9
GOLONG A9
*C10
GOLONG A10
*C11
GOLONG A11
*C12
GOLONG A12
*C13
GOLONG A13
*C14
GOLONG A14
*C15
GOLONG A15
*C16
GOLONG A16

*A1
GOLONG NXT
*A2
LC 00
GOSUBL AVC
GOLONG NXT
*A3
LC 01
GOSUBL AVC
GOLONG NXT
*A4
LC 02
GOSUBL AVC
GOLONG NXT
*A5
LC 03
GOSUBL AVC
GOLONG NXT
*A6
LC 04
GOSUBL AVC
GOLONG NXT
*A7
LC 05
GOSUBL AVC
GOLONG NXT
*A8
LC 06
GOSUBL AVC
GOLONG NXT
*A9
LC 07
GOSUBL AVC
GOLONG NXT
*A10
LC 08
GOSUBL AVC
GOLONG NXT
*A11
LC 09
GOSUBL AVC
GOLONG NXT
*A12
LC 0A
GOSUBL AVC
GOLONG NXT
*A13
LC 0B
GOSUBL AVC
GOLONG NXT
*A14
LC 0C
GOSUBL AVC
GOLONG NXT
*A15
LC 0D
GOSUBL AVC
GOLONG NXT
*A16
LC 0E
GOSUBL AVC
GOLONG NXT

*AVC
B=C B
AD1EX
LC 00024
*BIZARE
A=A+C A
B=B-1 B
GONC BIZARE
AD1EX
B=0 B
RTN

*NXT
LC 08
B=C B
*AAH
A=DAT1 4
?ST=0 0
GOYES ESIA
A=A+A A
*ESIA
?ST=0 1
GOYES ESI2
A=A+A A
*ESI2
?ST=0 2
GOYES ESI3
A=A+A A
*ESI3
C=DAT0 X
A=A!C X
DAT0=A X
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 4
B=B-1 B
GONC AAH
C=0 B

RTN

*TG
LA 020
LC 008
OUT=C
GOSBVL 01160
C=C&A X
?Cã0 X
GOYES YH
RTN
*YH
D0= 8010A
C=DAT0 A
GOSUBL LEFT
DAT0=C A
RTN
*TD
LA 020
LC 002
OUT=C
GOSBVL 01160
C=C&A X
?Cã0 X
GOYES YB
RTN
*YB
D0= 8010A
C=DAT0 A
GOSUBL RIGHT
DAT0=C A
RTN
*TG2
LA 001
LC 002
OUT=C
GOSBVL 01160
C=C&A X
?Cã0 X
GOYES YH.2
RTN
*YH.2
D0= 80116
C=DAT0 A
GOSUBL LEFT
DAT0=C A
RTN
*TD2
LA 001
LC 008
OUT=C
GOSBVL 01160
C=C&A X
?Cã0 X
GOYES YB.2
RTN
*YB.2
D0= 80116
C=DAT0 A
GOSUBL RIGHT
DAT0=C A
RTN


*LEFT
?CBIT=1 0
GOYES L1
?CBIT=1 1
GOYES L2
?CBIT=1 2
GOYES L3
?CBIT=1 3
GOYES L4
?CBIT=1 4
GOYES L5
?CBIT=1 5
GOYES L6
?CBIT=1 6
GOYES L7
?CBIT=1 7
GOYES L8
?CBIT=1 8
GOYES L9
?CBIT=1 9
GOYES L10
?CBIT=1 10
GOYES L11
?CBIT=1 11
GOYES L12
?CBIT=1 12
GOYES L13
?CBIT=1 13
GOYES L14
?CBIT=1 14
GOYES L15
?CBIT=1 15
GOYES L16

*L1
GOSUBL G1
RTN
*L2
GOSUBL G2
RTN
*L3
GOSUBL G3
RTN
*L4
GOSUBL G4
RTN
*L5
GOSUBL G5
RTN
*L6
GOSUBL G6
RTN
*L7
GOSUBL G7
RTN
*L8
GOSUBL G8
RTN
*L9
GOSUBL G9
RTN
*L10
GOSUBL G10
RTN
*L11
GOSUBL G11
RTN
*L12
GOSUBL G12
RTN
*L13
GOSUBL G13
RTN
*L14
GOSUBL G14
RTN
*L15
GOSUBL G15
RTN
*L16
GOSUBL G16
RTN

*G1
CBIT=0 0
CBIT=1 15
RTN
*G2
CBIT=0 1
CBIT=1 0
RTN
*G3
CBIT=0 2
CBIT=1 1
RTN
*G4
CBIT=0 3
CBIT=1 2
RTN
*G5
CBIT=0 4
CBIT=1 3
RTN
*G6
CBIT=0 5
CBIT=1 4
RTN
*G7
CBIT=0 6
CBIT=1 5
RTN
*G8
CBIT=0 7
CBIT=1 6
RTN
*G9
CBIT=0 8
CBIT=1 7
RTN
*G10
CBIT=0 9
CBIT=1 8
RTN
*G11
CBIT=0 10
CBIT=1 9
RTN
*G12
CBIT=0 11
CBIT=1 10
RTN
*G13
CBIT=0 12
CBIT=1 11
RTN
*G14
CBIT=0 13
CBIT=1 12
RTN
*G15
CBIT=0 14
CBIT=1 13
RTN
*G16
CBIT=0 15
CBIT=1 14
RTN

*RIGHT
?CBIT=1 0
GOYES H1
?CBIT=1 1
GOYES H2
?CBIT=1 2
GOYES H3
?CBIT=1 3
GOYES H4
?CBIT=1 4
GOYES H5
?CBIT=1 5
GOYES H6
?CBIT=1 6
GOYES H7
?CBIT=1 7
GOYES H8
?CBIT=1 8
GOYES H9
?CBIT=1 9
GOYES H10
?CBIT=1 10
GOYES H11
?CBIT=1 11
GOYES H12
?CBIT=1 12
GOYES H13
?CBIT=1 13
GOYES H14
?CBIT=1 14
GOYES H15
?CBIT=1 15
GOYES H16

*H1
GOSUBL I1
RTN
*H2
GOSUBL I2
RTN
*H3
GOSUBL I3
RTN
*H4
GOSUBL I4
RTN
*H5
GOSUBL I5
RTN
*H6
GOSUBL I6
RTN
*H7
GOSUBL I7
RTN
*H8
GOSUBL I8
RTN
*H9
GOSUBL I9
RTN
*H10
GOSUBL I10
RTN
*H11
GOSUBL I11
RTN
*H12
GOSUBL I12
RTN
*H13
GOSUBL I13
RTN
*H14
GOSUBL I14
RTN
*H15
GOSUBL I15
RTN
*H16
GOSUBL I16
RTN

*I1
CBIT=0 0
CBIT=1 1
RTN
*I2
CBIT=0 1
CBIT=1 2
RTN
*I3
CBIT=0 2
CBIT=1 3
RTN
*I4
CBIT=0 3
CBIT=1 4
RTN
*I5
CBIT=0 4
CBIT=1 5
RTN
*I6
CBIT=0 5
CBIT=1 6
RTN
*I7
CBIT=0 6
CBIT=1 7
RTN
*I8
CBIT=0 7
CBIT=1 8
RTN
*I9
CBIT=0 8
CBIT=1 9
RTN
*I10
CBIT=0 9
CBIT=1 10
RTN
*I11
CBIT=0 10
CBIT=1 11
RTN
*I12
CBIT=0 11
CBIT=1 12
RTN
*I13
CBIT=0 12
CBIT=1 13
RTN
*I14
CBIT=0 13
CBIT=1 14
RTN
*I15
CBIT=0 14
CBIT=1 15
RTN
*I16
CBIT=0 15
CBIT=1 0
RTN

*AVANCE
?ST=1 7
GOYES JR2.3
D0= 8010A
GOTO XJR2.3
*JR2.3
D0= 80116
*XJR2.3
C=DAT0 A

?CBIT=1 0
GOYES J1
?CBIT=1 1
GOYES J2
?CBIT=1 2
GOYES J3
?CBIT=1 3
GOYES J4
?CBIT=1 4
GOYES J5
?CBIT=1 5
GOYES J6
?CBIT=1 6
GOYES J7
?CBIT=1 7
GOYES J8
?CBIT=1 8
GOYES J9
?CBIT=1 9
GOYES J10
?CBIT=1 10
GOYES J11
?CBIT=1 11
GOYES J12
?CBIT=1 12
GOYES J13
?CBIT=1 13
GOYES J14
?CBIT=1 14
GOYES J15
?CBIT=1 15
GOYES J16

*J1
GOLONG K1
*J2
GOLONG K2
*J3
GOLONG K3
*J4
GOLONG K4
*J5
GOLONG K5
*J6
GOLONG K6
*J7
GOLONG K7
*J8
GOLONG K8
*J9
GOLONG K9
*J10
GOLONG K10
*J11
GOLONG K11
*J12
GOLONG K12
*J13
GOLONG K13
*J14
GOLONG K14
*J15
GOLONG K15
*J16
GOLONG K16

*K1
GOSUBL H
RTN
*K2
GOSUBL H
?ST=1 3
GOYES ALT1
ST=1 3
GOTO FALT
*ALT1
ST=0 3
GOSUBL D
*FALT  
RTN
*K3
GOSUBL H
GOSUBL D  
RTN
*K4
GOSUBL D
?ST=1 3
GOYES ALT1.2
ST=1 3
GOTO FALT.2
*ALT1.2
ST=0 3
GOSUBL H
*FALT.2  
RTN
*K5
GOSUBL D
RTN 
*K6
GOSUBL D
?ST=1 3
GOYES ALT1.3
ST=1 3
GOTO FALT.3
*ALT1.3
ST=0 3
GOSUBL B
*FALT.3  
RTN
*K7 
GOSUBL B
GOSUBL D  
RTN
*K8
GOSUBL B
?ST=1 3
GOYES ALT1.4
ST=1 3
GOTO FALT.4
*ALT1.4
ST=0 3
GOSUBL D
*FALT.4  
RTN
*K9
GOSUBL B
RTN
*K10
GOSUBL B
?ST=1 3
GOYES ALT1.5
ST=1 3
GOTO FALT.5
*ALT1.5
ST=0 3
GOSUBL G
*FALT.5  
RTN
*K11
GOSUBL B
GOSUBL G   
RTN
*K12
GOSUBL G
?ST=1 3
GOYES ALT1.6
ST=1 3
GOTO FALT.6
*ALT1.6
ST=0 3
GOSUBL B
*FALT.6  
RTN
*K13
GOSUBL G  
RTN
*K14
GOSUBL G
?ST=1 3
GOYES ALT1.7
ST=1 3
GOTO FALT.7
*ALT1.7
ST=0 3
GOSUBL H
*FALT.7  
RTN
*K15
GOSUBL H
GOSUBL G   
RTN
*K16
GOSUBL H
?ST=1 3
GOYES ALT1.8
ST=1 3
GOTO FALT.8
*ALT1.8
ST=0 3
GOSUBL G
*FALT.8  
RTN

*D
?ST=1 7
GOYES IGI
D0= 80107
GOTO XIGI
*IGI
D0= 80122
*XIGI
A=DAT0 B
LC 37
?AãC B
GOYES NLD
RTN
*NLD
?ST=1 7
GOYES IGI.2
D0= 80107
GOTO XIGI.2
*IGI.2
D0= 80122
*XIGI.2

A=DAT0 B
LC 1C
?A<C B
GOYES ADED3
?ST=1 7
GOYES IGI.7
D0= 80114
GOTO XIGI.7
*IGI.7
D0= 80126
*XIGI.7

A=DAT0 B
LC 44
?A=C B
GOYES ADED3
A=A+1 B
DAT0=A B
GOSUBL MAX1
GOSUBL MAX1
RTN
*ADED3
?ST=1 7
GOYES IGI.3
D0= 80107
GOTO XIGI.3
*IGI.3
D0= 80122
*XIGI.3

A=DAT0 A
A=A+1 B
DAT0=A B

GOSUBL MAX1

?ST=1 0
GOYES OA1
ST=1 0  
RTN
*OA1
?ST=1 1
GOYES OA2
ST=1 1
RTN
*OA2
?ST=1 2
GOYES OA3
ST=1 2
RTN
*OA3
?ST=1 7
GOYES IGI.4
A=R0
GOTO XIGI.4
*IGI.4
A=R3
*XIGI.4

A=A+1 A
?ST=1 7
GOYES IGI.5
R0=A
GOTO XIGI.5
*IGI.5
R3=A
*XIGI.5

ST=0 0
ST=0 1
ST=0 2
RTN

*G
?ST=1 7
GOYES IGI.9
D0= 80107
GOTO XIGI.9
*IGI.9
D0= 80122
*XIGI.9

A=DAT0 B
C=0 B
?AãC B
GOYES NLD2
RTN
*NLD2
?ST=1 7
GOYES IGI.10
D0= 80107
GOTO XIGI.10
*IGI.10
D0= 80122
*XIGI.10

A=DAT0 B
LC 1C
?A>C B
GOYES ADED4
?ST=1 7
GOYES IGI.11
D0= 80114
GOTO XIGI.11
*IGI.11
D0= 80126
*XIGI.11

A=DAT0 A
C=0 B
?A=C B
GOYES ADED4
A=A-1 B
DAT0=A B
GOSUBL MAX2
GOSUBL MAX2
RTN
*ADED4
?ST=1 7
GOYES IGI.12
D0= 80107
GOTO XIGI.12
*IGI.12
D0= 80122
*XIGI.12

A=DAT0 A
A=A-1 B
DAT0=A B

GOSUBL MAX2

?ST=1 0
GOYES OA1.2
?ST=1 7
GOYES IGI.13
A=R0
GOTO XIGI.13
*IGI.13
A=R3
*XIGI.13

A=A-1 A
?ST=1 7
GOYES IGI.14
R0=A
GOTO XIGI.14
*IGI.14
R3=A
*XIGI.14

ST=1 0
ST=1 1
ST=1 2
RTN
*OA1.2
?ST=1 1
GOYES OA2.2
ST=0 0
RTN
*OA2.2
?ST=1 2
GOYES OA3.2
ST=0 1
RTN
*OA3.2
ST=0 2
RTN

*H
?ST=1 7
GOYES JR2.4
D0= 80105
GOTO XJR2.4
*JR2.4
D0= 80120
*XJR2.4
A=DAT0 A
?Aã0 B
GOYES NLH
RTN
*NLH
?ST=1 7
GOYES JR2.12
A=R2
GOTO XJR2.12
*JR2.12
A=R4
*XJR2.12

LC 00040
A=A-C A
A=A-C A
?ST=1 7
GOYES JR2.13
R2=A
GOTO XJR2.13
*JR2.13
R4=A
*XJR2.13

GOSUBL P1

?ST=1 7
GOYES JR2.5
D0= 80105
GOTO XJR2.5
*JR2.5
D0= 80120
*XJR2.5

A=DAT0 B
LC 1C
?A>C B
GOYES ODED2

?ST=1 7
GOYES JR2.7
D0= 80112
GOTO XJR2.7
*JR2.7
D0= 80124
*XJR2.7

A=DAT0 B
?A=0 B
GOYES ODED2
A=A-1 B
DAT0=A B
RTN

*ODED2
?ST=1 7
GOYES JR2.6
D0= 80105
GOTO XJR2.6
*JR2.6
D0= 80120
*XJR2.6

A=DAT0 A
A=A-1 B
DAT0=A B
?ST=1 7
GOYES JR2.18
A=R0
GOTO XJR2.18
*JR2.18
A=R3
*XJR2.18

A=A-16 A
A=A-16 A
A=A-2 A
?ST=1 7
GOYES JR2.19
R0=A
GOTO XJR2.19
*JR2.19
R3=A
*XJR2.19

?ST=1 7
GOYES JR2.12+
A=R2
GOTO XJR2.12+
*JR2.12+
A=R4
*XJR2.12+

LC 00040
A=A+C A
?ST=1 7
GOYES JR2.13+
R2=A
GOTO XJR2.13+
*JR2.13+
R4=A
*XJR2.13+

RTN

*B
?ST=1 7
GOYES JR2.8
D0= 80105
GOTO XJR2.8
*JR2.8
D0= 80120
*XJR2.8

A=DAT0 B
LC 35
?AãC B
GOYES NLB
RTN
*NLB
?ST=1 7
GOYES JR2.15
A=R2
GOTO XJR2.15
*JR2.15
A=R4
*XJR2.15

LC 00040
A=A+C A
A=A+C A
?ST=1 7
GOYES JR2.16
R2=A
GOTO XJR2.16
*JR2.16
R4=A
*XJR2.16

GOSUBL P1

?ST=1 7
GOYES JR2.9
D0= 80105
GOTO XJR2.9
*JR2.9
D0= 80120
*XJR2.9

A=DAT0 B
LC 1C
?A<C B
GOYES ADED

?ST=1 7
GOYES JR2.10
D0= 80112
GOTO XJR2.10
*JR2.10
D0= 80124
*XJR2.10

A=DAT0 A
LC 44
?A=C B
GOYES ADED
A=A+1 B
DAT0=A B
RTN
*ADED
?ST=1 7
GOYES JR2.11
D0= 80105
GOTO XJR2.11
*JR2.11
D0= 80120
*XJR2.11

A=DAT0 A
A=A+1 B
DAT0=A B

?ST=1 7
GOYES JR2.17
A=R0
GOTO XJR2.17
*JR2.17
A=R3
*XJR2.17

A=A+16 A
A=A+16 A
A=A+2 A
?ST=1 7
GOYES JR2.20
R0=A
GOTO XJR2.20
*JR2.20
R3=A
*XJR2.20

?ST=1 7
GOYES JR2.15+
A=R2
GOTO XJR2.15+
*JR2.15+
A=R4
*XJR2.15+

LC 00040
A=A-C A
?ST=1 7
GOYES JR2.16+
R2=A
GOTO XJR2.16+
*JR2.16+
R4=A
*XJR2.16+

RTN

*P1
?ST=0 7
GOYES JR2.14
GOLONG P1.2
*JR2.14

C=R2
D1=C
D0= 80100
A=DAT0 A
LC 00880
A=A+C A
D0=A

LC 3F
B=C A
*AAN
A=DAT1 W
GOSUBL VANESSA
DAT0=A W

D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
AD1EX
LC 00040
A=A+C A
AD1EX
B=B-1 B
GONC AAN
C=0 B
RTN
*P1.2
C=R4
D1=C
D0= 80100
A=DAT0 A
LC 00880
A=A+C A
D0=A
D0=D0+ 16
LC 3F
B=C A
*AAN.2
A=DAT1 W
GOSUBL VANESSA
DAT0=A W
D0=D0+ 16
LC FF
DAT0=C 1

D0=D0+ 16
D0=D0+ 2
AD1EX
LC 00040
A=A+C A
AD1EX
B=B-1 B
GONC AAN.2
C=0 B
RTN

*VANESSA
?ST=0 4
GOYES UU1
A=A+A W
*UU1
?ST=0 5
GOYES UU2
A=A+A W
*UU2
?ST=0 6
GOYES UU3
A=A+A W
*UU3
ABIT=1 0
ABIT=1 1
ABIT=1 2
ABIT=1 3
RTN

*MAX2
?ST=1 4
GOYES OA5
ST=1 4  
GOTO LDF
*OA5
?ST=1 5
GOYES OA5.2
ST=1 5
GOTO LDF
*OA5.2
?ST=1 6
GOYES OA5.3
ST=1 6
GOTO LDF
*OA5.3
?ST=1 7
GOYES IGI.16
A=R2
GOTO XIGI.16
*IGI.16
A=R4
*XIGI.16
A=A-1 A
?ST=1 7
GOYES IGI.17
R2=A
GOTO XIGI.17
*IGI.17
R4=A
*XIGI.17

ST=0 4
ST=0 5
ST=0 6
*LDF
GOSUBL P1
RTN

*MAX1
?ST=1 4
GOYES OA4
?ST=1 7
GOYES IGI.6
A=R2
GOTO XIGI.6
*IGI.6
A=R4
*XIGI.6
A=A+1 A
?ST=1 7
GOYES IGI.8
R2=A
GOTO XIGI.8
*IGI.8
R4=A
*XIGI.8

ST=1 4
ST=1 5
ST=1 6
GOTO LDF2
*OA4
?ST=1 5
GOYES OA4.2
ST=0 4
GOTO LDF2
*OA4.2
?ST=1 6
GOYES OA4.3
ST=0 5
GOTO LDF2
*OA4.3
ST=0 6
*LDF2
GOSUBL P1
RTN

*çAC1

D0= 8010E
A=DAT0 B
?Aã0 B
GOYES TOUR.2
ST=0 7
GOSUBL TG
GOSUBL TD

D0= 80110
C=DAT0 B
D0=D0- 2
DAT0=C B

*TOUR.2

D0= 8010E
A=DAT0 B
A=A-1 B
DAT0=A B

ST=0 7
D0= 80128
A=DAT0 A
R1=A
GOSUBL TT
A=R1
D0= 80128
DAT0=A A
GOLONG RETOUR1

*çAC2
D0= 8013C
A=DAT0 B
?Aã0 B
GOYES TOUR

C=ST
D0= 8011A
DAT0=C X
D0= 8011D
C=DAT0 X
ST=C
ST=1 7
GOSUBL TG2
GOSUBL TD2
ST=0 7
D0= 8011D
C=ST
DAT0=C X
D0= 8011A
C=DAT0 X
ST=C

D0= 8013E
C=DAT0 B
D0=D0- 2
DAT0=C B
*TOUR
D0= 8013C
A=DAT0 B
A=A-1 B
DAT0=A B

C=ST
D0= 8011A
DAT0=C X
D0= 8011D
C=DAT0 X
ST=C
ST=1 7
D0= 8012D
A=DAT0 A
R1=A
GOSUBL TT2
A=R1
D0= 8012D
DAT0=A A

ST=0 7
D0= 8011D
C=ST
DAT0=C X
D0= 8011A
C=DAT0 X
ST=C
GOLONG RETOUR2


*GREEN
LA 00001
?C>A A
GOYES TP1
LC 12
DAT0=C B
RTN
*TP1
LA 00002
?C>A A
GOYES TP2
LC 08
DAT0=C B
RTN
*TP2
LA 00003
?C>A A
GOYES TP3
LC 07
DAT0=C B
RTN
*TP3
LA 00004
?C>A A
GOYES TP4
LC 06
DAT0=C B
*TP4
LA 00005
?C>A A
GOYES TP5
LC 05
DAT0=C B
*TP5
LA 00006
?C>A A
GOYES TP6
LC 04
DAT0=C B
*TP6
LA 00007
?C>A A
GOYES TP7
LC 03
DAT0=C B
*TP7
LA 00008
?C>A A
GOYES TP8
LC 02
DAT0=C B
*TP8
LC 01
DAT0=C B
RTN

*DECOR1
%H
A=R0
D0=A
D0=D0- 16
D0=D0- 16
D0=D0- 2
A=DAT0 X
?A=0 X
GOYES NATALIE
%B
A=R0
LC 00130
A=A+C A
D0=A
A=DAT0 X
?A=0 X
GOYES NATALIE

D0= 80110
LC 01
DAT0=C B
D0= 80128
LC 10
DAT0=C B
*NATALIE

RTN

*DECOR2
%H
A=R3
D0=A
D0=D0- 16
D0=D0- 16
D0=D0- 2
A=DAT0 X
?A=0 X
GOYES NATALIE2
%B
A=R3
LC 00130
A=A+C A
D0=A
A=DAT0 X
?A=0 X
GOYES NATALIE2


D0= 8013E
LC 01
DAT0=C B
D0= 8012D
LC 10
DAT0=C B
*NATALIE2

RTN

*çLCD
D0= 80100
A=DAT0 A
D0=A
LC 00880
A=A+C A
A=A+C A
D1=A
LC 87
B=C B
*AAT
A=DAT1 W
DAT0=A W
D0=D0+ 16
D1=D1+ 16
B=B-1 B
GONC AAT
B=0 B
RTN

@