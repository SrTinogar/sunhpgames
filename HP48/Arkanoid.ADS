HPHP48-R,*09
GOSBVL 0679B
INTOFF CLRST
LC F D0= 00128 DAT0=C.P
LC 00990 GOSBVL 05B7D AD0EX ABIT=0.0 LC 000CC A=A+C.A R0=A
A=R0 D0=A A=0.W LC 87 A=0.W DO { DAT0=A.W D0=D0+ 16 C--.B } WHILENC
A=R0 D0= 00120 DAT0=A.A
GOSUB EC
LC 3 D0= 80108 DAT0=C.P %VIE
*REPLAY
LC 41 D0= 00 DAT0=C.B %X.BALL
LC 36 D0= 02 DAT0=C.B %Y.BALL
LC 3D D0= 04 DAT0=C.B %X.RAK
LC 3A D0= 06 DAT0=C.B %Y.RAK
GOSUB çBALL GOSUB çRAK
A=R0 LC 0085E A=A+C.A D0=A A=0.W DAT0=A.W  D1= 80108 C=DAT1.P D=C.P LC 7
DO { DAT0=C.P D0=D0+ 1 D--.P } WHILENC
*KEY GOSBVL 00E0B GOC KEY *STOP GOSBVL 00E0B GONC STOP
GOSUB çBALL GOSUB çRAK

*LCD
D0= 80102 A=DAT0.B LC 3A
?A=C.B { D0= 08 A=DAT0.P ?A=0.P { GOTO QUIT }
ELSE { A--.P DAT0=A.P } GOTO REPLAY }
GOSUB çBALL GOSUB çRAK
LC 600 DO { C--.X } WHILENC
GOSUB çCBALL
?ST=0.2 {
GOSUB ?D ?ST=0.0 { D0= 80100 A=DAT0.B LC 7D ?A<C.B { A++.B DAT0=A.B } ELSE { ST=1.0 }  }
GOSUB ?G ?ST=1.0 { D0= 80100 A=DAT0.B C=0.B ?A>C.B { A--.B DAT0=A.B } ELSE { ST=0.0 } }
ST=1.2 } ELSE { ST=0.2 }
GOSUB ?H ?ST=0.1 { D0= 80102 A=DAT0.B C=0.B ?A>C.B { A--.B DAT0=A.B } ELSE { ST=1.1 }  }
GOSUB ?B ?ST=1.1 { GOSUB ?B D0= 80102 A=DAT0.B LC 3A ?A<C.B { A++.B DAT0=A.B } ELSE { ST=0.1 } }
GOSUB çRAK
LC 004 GOSBVL 01EEC ?CBIT=1.1 { D0= 80104 A=DAT0.B LC 77 ?A<C.B { A++.B DAT0=A.B } }
LC 004 GOSBVL 01EEC ?CBIT=1.3 { D0= 80104 A=DAT0.B C=0.B ?A>C.B { A--.B DAT0=A.B } }
GOSUB TQ GOTO LCD

*TQ
LC 010 OUT=C GOSBVL 01EEC ?CBIT=0.4 RTNYES
*QUIT
D0= 00128 LC 7 DAT0=C.P
D0= 8068D A=DAT0.A D0= 00120 DAT0=A.A
GOVLNG 05143

*EC
A=R0 R4=A LC A R2=C LC 6 R3=C
*REP
GOSUB BRK
$FF701080DFF0DFF0DFF0EFF0
*BRK
C=RSTK D1=C A=R4 D0=A LC 5 DO { A=DAT1.X DAT0=A.X D0=D0+ 34 D1=D1+ 4 C--.P } WHILENC
C=R2 ?C=0.P { LA A R2=A A=R3 ?A=0.P { RTN } ELSE { A--.P R3=A A=R4 LC 000AE A=A+C.A R4=A GOTO REP  } A--.P R3=A } ELSE { C--.P R2=C A=R4 A=A+3.A R4=A }
GOTO REP

*çBALL
GOSUB BALL
$60D0F060
*BALL
C=RSTK D1=C C=R0
D0= 80100 A=0.A A=DAT0.B ASRB.B ASRB.B   C=C+A.A
D0= 80102 A=0.A A=DAT0.B
B=A.A ASL.A A=A+B.A A=A+A.A C=C+A.A
D0= 80100 A=DAT0.B B=A.B D0=C
LC 3 D=C.P C=B.B DO { A=DAT1.B ?CBIT=1.0 { A=A+A.B } ?CBIT=1.1 { A=A+A.B A=A+A.B } B=C.B C=DAT0.B C=-C-1.B A=A&C.B C=DAT0.B A=A!C.B DAT0=A.B C=B.B D0=D0+ 34 D1=D1+ 2 D--.P } WHILENC
RTN

*çRAK
GOSUB RAK
$EF703080FFB0EF70
*RAK
C=RSTK D1=C C=R0
D0= 80104 A=0.A A=DAT0.B ASRB.B ASRB.B   C=C+A.A
D0= 06 A=0.A A=DAT0.B
B=A.A ASL.A A=A+B.A A=A+A.A C=C+A.A
D0= 80104 A=DAT0.B B=A.B D0=C
LC 3 D=C.P C=B.B DO { A=DAT1.4 ?CBIT=1.0 { A=A+A.A } ?CBIT=1.1 { A=A+A.A A=A+A.A } B=C.B C=DAT0.4 C=-C-1.A A=A&C.A DAT0=A.4 C=B.B D0=D0+ 34 D1=D1+ 4 D--.P } WHILENC
RTN

*?H
D0= 80102 A=DAT0.B ?A=0.B RTNYES
GOSUB GET
LA 00022 C=C-A.A D0=C
A=DAT0.B
?Aã0.B { ST=1.1
D0= 80100 A=0.W A=DAT0.B C=0.W LC C GOSBVL 65807 C=A.A C=C+C.A C=C+A.A RSTK=C
D0= 02 A=0.W A=DAT0.B C=0.W LC 6 GOSBVL 65807 C=A.A A=A+A.A A=A+C.A A=A+A.A   C=A.A ASL.A A=A+C.A A=A+A.A
C=RSTK A=A+C.A
C=R0 C=C+A.A LA 000CC C=C-A.A  D0=C A=0.X LC 5
DO { DAT0=A.X D0=D0+ 34 C--.P } WHILENC }
RTN

*?B
GOSUB GET
LA 00088 C=C+A.A D0=C
A=DAT0.B ?Aã0.B { ST=0.1 }
RTN

*?D
D0= 80100 A=DAT0.B LC 76 ?A>C.B RTNYES
GOSUB GET
 LA 00022 C=C-A.A D0=C
D0=D0+ 3 A=DAT0.B
?Aã0.B {
D0= 80100 A=0.W A=DAT0.B C=0.W LC C GOSBVL 65807 C=A.A C=C+C.A C=C+A.A RSTK=C
D0= 02 A=0.W A=DAT0.B C=0.W LC 6 GOSBVL 65807 C=A.A A=A+A.A A=A+C.A A=A+A.A   C=A.A ASL.A A=A+C.A A=A+A.A
C=RSTK A=A+C.A
C=R0 C=C+A.A C=C+3.A D0=C A=0.X LC 5
DO { DAT0=A.X D0=D0+ 34 C--.P } WHILENC }
RTN

*?G
D0= 80100 A=DAT0.B LC 0C ?A<C.B RTNYES
GOSUB GET
LA 00022 C=C-A.A D0=C
D0=D0- 3 A=DAT0.B
?Aã0.B {
D0= 80100 A=0.W A=DAT0.B C=0.W LC C GOSBVL 65807 C=A.A C=C+C.A C=C+A.A RSTK=C
D0= 80102 A=0.W A=DAT0.B C=0.W LC 6 GOSBVL 65807 C=A.A A=A+A.A A=A+C.A A=A+A.A   C=A.A ASL.A A=A+C.A A=A+A.A
C=RSTK A=A+C.A
C=R0 C=C+A.A C=C-3.A D0=C A=0.X LC 5
DO { DAT0=A.X D0=D0+ 34 C--.P } WHILENC }
RTN

*çCBALL
C=R0
D0= 80100 A=0.A A=DAT0.B ASRB.B ASRB.B   C=C+A.A
D0= 80102 A=0.A A=DAT0.B
B=A.A ASL.A A=A+B.A A=A+A.A C=C+A.A D0=C
D1= 80100 A=DAT1.B LC 04
*LOOP ?A>C.B { A=A-C.B GOTO LOOP } C=0.B
?ABIT=0.0 { ?ABIT=0.1 { GOTO Y1 } ELSE { GOTO Y3 } }
ELSE { ?ABIT=0.1 { GOTO Y2 } ELSE { GOTO Y4 } }
*Y1 LA 3 DO { DAT0=C.P D0=D0+ 34 A--.P } WHILENC RTN
*Y2 LA 3 DO { C=DAT0.B CBIT=0.1 CBIT=0.2 CBIT=0.3 CBIT=0.4 DAT0=C.B D0=D0+ 34 A--.P } WHILENC RTN
*Y3 LA 3 DO { C=DAT0.B CBIT=0.2 CBIT=0.3 CBIT=0.4 CBIT=0.5 DAT0=C.B D0=D0+ 34 A--.P } WHILENC RTN
*Y4 LA 3 DO { C=DAT0.B CBIT=0.3 CBIT=0.4 CBIT=0.5 CBIT=0.6 DAT0=C.B D0=D0+ 34 A--.P } WHILENC RTN

*GET
C=R0 D0= 80100 A=0.A A=DAT0.B ASRB.B ASRB.B   C=C+A.A
D0= 80102 A=0.A A=DAT0.B
B=A.A ASL.A A=A+B.A A=A+A.A C=C+A.A
RTN

@