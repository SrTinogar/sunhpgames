HPHP48-R,*p
INTOFF  
GOSBVL 0679B
GOSUBL C-
LC 01B00
GOSBVL 05B7D
AD0EX
A=A+1 A
ABIT=0 0
LC 80000
A=A-C A
D0= 80400
DAT0=A A
LC 00880
A=A+C A
D0= 80405
DAT0=A A
A=A+C A
D0= 80411
DAT0=A A
%%
D0= 8068D
A=DAT0 A
LC 80000
A=A-C A
D0= 80430
DAT0=A A
LC 00220
A=A+C A
D0= 80420 %OLD 80211%
DAT0=A A

%%%%%%%%%%%%%%%%%%%%%%

GOSBVL  01115
P=      0
C=0 X
D0=     0012E
DAT0=C  P
GOSUBL  F452B
$59085F660084F061361B002001441640715CF16F8F06517808BF606D3085C1A8310AF280897A6E15C719101A502015EF061841461340787F200F86EA21B114001461B0210014486DB084E84D57485D4141AD73015601A001015401AE73015631A521015431B004001461B0210014485E1983AF280897A6E15C71A502015EF061841461340787F200F
*F452B
C=RSTK  
LA      C0000
?CäA    A
GOYES   F4548
LA      80000
C=C-A   A
*F4548
D0=     8000F
A=DAT0  7
D1=     80092
DAT1=A  7
LA      D8
DAT0=A  B
D0=D0+  2
DAT0=C  A
A=PC    
LC      00064
C=C+A   A
LA      C0000
?CäA    A
GOYES   F4596
LA      80000
C=C-A   A
*F4596
RSTK=C  
LC      72402
RSTK=C  
LC      109AB
RSTK=C  
LC      72402
RSTK=C  
LC      01C3D
RSTK=C  
LC      80000
D0=     8000A
A=DAT0  A
B=0     A
GOVLNG  1CC4D
D0=     00128
LC      F
DAT0=C  P
D1=     00138
D0=     2F
LC      3
DAT0=C  1
D0=     00128
*F45FD
A=DAT0  B
A=A+A   B
A=A+A   B
?Aã0    B
GOYES   F45FD
C=0     W
LC      2
DAT1=C  8
GOSUB   F461D
GOTO    F461F
*F461D
RTI     
*F461F
ST=0    12
GOTO    F4637
GOSBVL  067D2
A=DAT0  A
D0=D0+  5
PC=(A)  
*F4637

%%%%%%%%%%%%%%%%%%%%%%
GOSUBL INI_GREY
GOSUBL C+

*_MAIN
GOSBVL 01115
GOSUBL INITIATION
ST=0 12
LA 8
D0= 0037D
DAT0=A P
D0= 0037E
A=0 X
DAT0=A X
GOSUBL INI_GREY

*LK

LC 100
OUT=C
GOSBVL 71560
?CBIT=0 4
GOYES NPLAY
GOLONG _JEU
*NPLAY
?ST=1 12
GOYES YQUIT
LC 100
OUT=C
GOSBVL 71560
?CBIT=0 0
GOYES NQUIT
*YQUIT
GOLONG QUIT
*NQUIT
GOTO LK

*_JEU
GOSUBL HI
GOSUBL CLMEM
GOSUBL CADRE
GOSUBL INI_BLOC
GOSUBL BLOC
GOSUBL SCORE
GOSUBL LEVEL

*LCD
GOSUBL KERNEL
GOSUBL DIRECTION
GOSUBL TQ
GOLONG LCD

*TQ
LC 010
OUT=C
GOSBVL 71560
?CBIT=0 0
RTNYES
GOSUBL HI
GOLONG _MAIN

*CLMEM
D0= 00400
A=DAT0 A
D0=A
LC 197
A=0 W
*CLM
DAT0=A W
D0=D0+ 16
C=C-1 X
GONC CLM
RTN

*CADRE
D0= 00400
A=DAT0 A
LC 00022
A=A+C A
D0=A
LC 10
A=0 W
A=-A-1 W
*AF1'
DAT0=A 6
D0=D0+ 6
C=C-1 B
GONC AF1'

D0= 00400
A=DAT0 A
LC 007F8
A=A+C A
D0=A
LC 10
A=0 W
A=-A-1 W
*AF2'
DAT0=A 6
D0=D0+ 6
C=C-1 B
GONC AF2'

D0= 00400
A=DAT0 A
D0=A
LC 3F
A=0 P
A=-A-1 P
*AF3'
ABIT=0 0
DAT0=A P
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 B
GONC AF3'

D0= 00400
A=DAT0 A
LC 0001E
A=A+C A
D0=A
GOSUBL CAD

D0= 00411
A=DAT0 A
D0=A
LC 10
A=0 W
A=-A-1 W
*AF1'2
DAT0=A 8
D0=D0+ 8
C=C-1 B
GONC AF1'2

D0= 00411
A=DAT0 A
LC 007F8
A=A+C A
D0=A
LC 10
A=0 W
A=-A-1 W
*AF2'2
DAT0=A 8
D0=D0+ 8
C=C-1 B
GONC AF2'2

D0= 00411
A=DAT0 A
D0=A
LC 3F
A=0 P
A=-A-1 P
*AF3'2
DAT0=A P
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 B
GONC AF3'2

D0= 00411
A=DAT0 A
LC 0001E
A=A+C A
D0=A
GOSUBL CAD
RTN

*CAD
GOSUB SCOR
$FF70FF703060B660BA603B6030603760B860B86030603760B86037603060BF603A60B56030603760BA60B86030603560306030603060306030603060306030603060306030603060306030603060306030603060306030603060306030603F60B060B060306035603060306030603060306030603060306030603060FF70FF70
*SCOR
C=RSTK
D1=C
LC 3F
*AF4'
A=DAT1 X
DAT0=A X
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 4
C=C-1 B
GONC AF4'
RTN

*BLOC
D0= 00430
C=DAT0 A
B=C A
D1=C
D0= 00410
A=DAT0 P
C=0 P
?A=C P
GOYES AF_0
C=C+1 P
?A=C P
GOYES AF_1
C=C+1 P
?A=C P
GOYES AF_2
C=C+1 P
?A=C P
GOYES AF_3
RTN

*AF_0
GOTO AF0
*AF_1
GOTO AF1
*AF_2
GOTO AF2
*AF_3
GOTO AF3

*AF0
A=R0
D0=A
GOSUBL _V
A=R0
LC 01100
A=A+C A
D0=A
A=B A
LC 00110
A=A+C A
D1=A
GOSUBL _V
RTN

*AF1
A=R0
LC 0010E
A=A-C A
D0=A
GOSUBL _H
A=R0
LC 0010E
A=A-C A
LC 01100
A=A+C A
D0=A
A=B A
LC 00110
A=A+C A
D1=A
GOSUBL _H

A=R0
D0=A
D0=D0+ 2
A=B A
D1=A
D1=D1+ 2
GOSUBL _H
A=R0
LC 01100
A=A+C A
D0=A
D0=D0+ 2
A=B A
LC 00110
A=A+C A
D1=A
D1=D1+ 2
GOSUBL _H

A=R0
LC 00112
A=A+C A
D0=A
A=B A
D1=A
D1=D1+ 4
GOSUBL _H
A=R0
LC 00112
A=A+C A
LC 01100
A=A+C A
D0=A
A=B A
LC 00110
A=A+C A
D1=A
D1=D1+ 4
GOSUBL _H
RTN

*AF2
A=R0
D0=A
D0=D0+ 4
GOSUBL _H
A=R0
LC 01100
A=A+C A
D0=A
D0=D0+ 4
A=B A
LC 00110
A=A+C A
D1=A
GOSUBL _H

A=B A
D1=A
D1=D1+ 2
A=R0
D0=A
D0=D0+ 2
GOSUBL _H
A=B A
LC 00110
A=A+C A
D1=A
D1=D1+ 2
A=R0
LC 01100
A=A+C A
D0=A
D0=D0+ 2
GOSUBL _H

A=B A
D1=A
D1=D1+ 4
A=R0
D0=A
GOSUBL _H
A=B A
LC 00110
A=A+C A
D1=A
D1=D1+ 4
A=R0
LC 01100
A=A+C A
D0=A
GOSUBL _H
RTN

*AF3
A=R0
LC 0010E
A=A-C A
D0=A
D1=D1+ 4
GOSUBL _H
A=R0
LC 0010E
A=A-C A
LC 01100
A=A+C A
D0=A
A=B A
LC 00110
A=A+C A
D1=A
D1=D1+ 4
GOSUBL _H

A=R0
D0=A
D0=D0+ 2
A=B A
D1=A
D1=D1+ 2
GOSUBL _H
A=R0
LC 01100
A=A+C A
D0=A
D0=D0+ 2
A=B A
LC 00110
A=A+C A
D1=A
D1=D1+ 2
GOSUBL _H

A=R0
LC 00112
A=A+C A
D0=A
A=B A
D1=A
GOSUBL _H
A=R0
LC 00112
A=A+C A
LC 01100
A=A+C A
D0=A
A=B A
LC 00110
A=A+C A
D1=A
GOSUBL _H
RTN

*KERNEL
LC 004
OUT=C
GOSBVL 71560
?CBIT=1 3
GOYES FAST
D0= 00445
C=DAT0 X
GOTO NFAST
*FAST
LC 080
*NFAST
D0= 0040A
A=DAT0 A
?AäC X
GOYES GO
A=A+1 X
DAT0=A X
RTN
*GO
D0= 0040A
A=0 X
DAT0=A X
GOSUBL SCORE
GOSUBL LEVEL
GOSUBL BLOC
GOSUBL CHUTE
GOSUBL BLOC
RTN

*CHUTE
GOSUBL CLIC
D0= 00410
A=DAT0 P
?A=0 P
GOYES CH.1
LC 2
?A=C P
GOYES CH.1
GOTO CH.2
*CH.1
ST=0 0
A=R0
D0=A
D0=D0- 1
LC 7
*TSB
A=DAT0 P
?ABIT=0 3
GOYES NB
ST=1 0
*NB
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 P
GONC TSB
?ST=0 0
GOYES NBB
GOSUBL BLOC
GOSUBL CHECK
GOLONG INI_BLOC
*NBB
A=R0
A=A-1 A
R0=A
RTN
*CH.2
ST=0 0
A=R0
LC 00110
A=A-C A
D0=A
D0=D0+ 1
LC 17
*TSB.2
A=DAT0 P
?A=0 P
GOYES NB.2
ST=1 0
*NB.2
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 B
GONC TSB.2
?ST=0 0
GOYES NBB.2
GOSUBL BLOC
GOSUBL CASE
GOSUBL CHECK
GOLONG INI_BLOC
*NBB.2
A=R0
A=A-1 A
R0=A
RTN

*INI_BLOC
D0= 00400
A=DAT0 A
LC 003D0
A=A+C A
R0=A
A=0 P
D0= 00410
DAT0=A P
GOSUBL TFIN
GOSUBL DATA
$E7E7E7E7E7E7E7E7E7E7E7E7E7E7E7E700FF3CFFFF181818181818181818181818007EDBFFFB181818181818181818181818003CDBFFF9181818181818181818181818003CDBFFF8181818181818181818181818007EDBFF7818181818181818181818181800FF3CFF3818181818181818181818181800E7E7E7E7E7E7E7E7E7E7E7E7E7E7E7E700E7E7E7E7E7E7E7E7E7E7E7E7E7E7E7E700FF3C7E1C18181818181818181818181800FF187E1E18181818181818181818181800FF99181F18181818181818181818181800FF99189F18181818181818181818181800FF187EDF18181818181818181818181800FF3C7EFF18181818181818181818181800E7E7E7E7E7E7E7E7E7E7E7E7E7E7E7E700
*DATA
C=RSTK
D1=C
D=C A
LC 2
B=C P
D0= 00430
A=DAT0 A
D0=A
*RANDOM
D1= 00137
A=DAT1 A
D1=A
A=0 A
A=DAT1 P
ASRB P
ASRB P %0ç3%
C=D A
C=C+A A
C=C+A A
D1=C
LC F
*AFR
A=DAT1 B
DAT0=A B
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
C=C-1 P
GONC AFR
AD0EX
LC 0021E
A=A-C A
AD0EX
B=B-1 P
GONC RANDOM
RTN

*TFIN
A=R0
D0=A
LC 7
A=0 W
*TF
A=DAT0 6
?Aã0 W
GOYES YF
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 P
GONC TF
RTN
*YF
C=RSTK
C=RSTK
GOSUBL BLOC
LC 10000
*WT
C=C-1 A
GONC WT
%END%
GOSUBL WALL
GOSUBL K_R
GOSUBL K_P
C=RSTK
C=RSTK
GOLONG _MAIN

*T_UP
LC 008
OUT=C
GOSBVL 71560
?CBIT=0 2
RTNYES
D0= 00410
A=DAT0 P
?A=0 P
GOYES T_UP.1
LC 2
?A=C P
GOYES T_UP.1
GOTO T_UP.2
*T_UP.1
A=R0
LC 00022
A=A-C A
D0=A
A=0 W
A=DAT0 6
?Aã0 W
RTNYES
GOSUBL BLOC
A=R0
LC 00110
A=A-C A
R0=A
GOSUBL BLOC
RTN
*T_UP.2
A=R0
LC 00130
A=A-C A
D0=A
A=DAT0 B
?Aã0 B
RTNYES
GOSUBL BLOC
A=R0
LC 00110
A=A-C A
R0=A
GOSUBL BLOC
RTN

*T_DW
LC 002
OUT=C
GOSBVL 71560
?CBIT=0 2
RTNYES
D0= 00410
A=DAT0 P
?A=0 P
GOYES T_DW.1
LC 2
?A=C P
GOYES T_DW.1
GOTO T_DW.2
*T_DW.1
A=R0
LC 00110
A=A+C A
D0=A
A=0 W
A=DAT0 6
?Aã0 W
RTNYES
GOSUBL BLOC
A=R0
LC 00110
A=A+C A
R0=A
GOSUBL BLOC
RTN
*T_DW.2
A=R0
LC 00222
A=A+C A
D0=A
A=DAT0 B
?Aã0 B
RTNYES
GOSUBL BLOC
A=R0
LC 00110
A=A+C A
R0=A
GOSUBL BLOC
RTN

*T_RT
LC 004
OUT=C
GOSBVL 71560
?CBIT=1 2
GOYES PUSH_1
ST=0 2
RTN
*PUSH_1
?ST=1 2
RTNYES
ST=1 2
ST=0 1 %WALL_UP ?
ST=0 3 %WALL_DW ?
D0= 00410
A=DAT0 P
?A=0 P
GOYES R_1
LC 2
?A=C P
GOYES R_1
GOTO R_2
*R_1
A=R0
LC 00022
A=A-C A
D0=A
A=0 W
A=DAT0 6
?A=0 W
GOYES NM_1
C=0 A
C=-C-1 A
?AãC A
RTNYES
ST=1 1
*NM_1
A=R0
LC 00110
A=A+C A
D0=A
A=0 W
A=DAT0 6
?A=0 W
GOYES NM_2
C=0 A
C=-C-1 A
?AãC A
RTNYES
ST=1 3
*NM_2
GOSUBL BLOC
?ST=0 1
GOYES NW_1
A=R0
LC 00222
A=A+C A
D0=A
A=DAT0 B
?A=0 B
GOYES _F1
GOSUBL BLOC
RTN
*_F1
A=R0
LC 00110
A=A+C A
R0=A
ST=0 1
*NW_1
?ST=0 3
GOYES NW_2
A=R0
LC 0021E
A=A-C A
D0=A
A=DAT0 B
?A=0 B
GOYES _F2
GOSUBL BLOC
RTN
*_F2

A=R0
LC 00110
A=A-C A
R0=A
ST=0 3
*NW_2
D0= 00410
A=DAT0 P
LC 3
?A=C P
GOYES T_MAX_1
A=A+1 P
DAT0=A P
GOSUBL BLOC
RTN
*T_MAX_1
A=0 P
DAT0=A P
GOSUBL BLOC
RTN

*R_2
A=R0
LC 00110
A=A-C A
D0=A
LC 17
*TB_3
A=DAT0 B
?Aã0 B
RTNYES
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 B
GONC TB_3
GOSUBL BLOC
D0= 00410
A=DAT0 P
LC 3
?A=C P
GOYES T_MAX_2
A=A+1 P
DAT0=A P
GOSUBL BLOC
RTN
*T_MAX_2
A=0 P
DAT0=A P
GOSUBL BLOC
RTN

*DIRECTION
D0= 0040D
A=DAT0 X
LC 150
?A=C X
GOYES GO2
A=A+1 X
DAT0=A X
RTN
*GO2
D0= 0040D
A=0 X
DAT0=A X
GOSUBL T_UP
GOSUBL T_DW
GOSUBL T_RT
RTN

*_V
LC 7
D=C P
*AFB
A=DAT1 6
C=DAT0 6
C=-C-1 W
A=A&C W
DAT0=A 6
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
D=D-1 P
GONC AFB
RTN

*_H
LC 7
D=C P
*AFB.1
A=DAT1 B
C=DAT0 B
C=-C-1 B
A=A&C B
DAT0=A B
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
D=D-1 P
GONC AFB.1
RTN

*WALL
D0= 00411
A=DAT0 A
LC 00088
A=A+C A
D0=A
LA E
B=A P
*W_2
LC 6
D=C P
*W_L
GOSUB DAT
$E73CDBDBDBDB3CE7
*DAT
C=RSTK
D1=C
LC 7
*AF_D
A=DAT1 B
DAT0=A B
RSTK=C
AD0EX
LC 01100
A=A-C A
AD0EX
LA FF
DAT0=A B
AD0EX
A=A+C A
AD0EX
C=RSTK
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 2
C=C-1 P
GONC AF_D
D=D-1 P
GONC W_L
AD0EX
LC 0076E
A=A-C A
AD0EX
LC 02000
*WT2
C=C-1 A
GONC WT2
GOSUBL CLIC
B=B-1 P
GONC W_2'
RTN
*W_2'
GOTO W_2

*K_R
LC 1FF
OUT=C
GOSBVL 71560
?Cã0 X
GOYES K_R
RTN

*K_P
LC 1FF
OUT=C
GOSBVL 71560
?C=0 X
GOYES K_P
RTN

*CASE
A=R0
LC 0010E
A=A-C A
D1=A
D0= 00420
A=DAT0 A
D0=A
LC 17
*COPY
A=DAT1 B
DAT0=A B
D0=D0+ 2
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
C=C-1 B
GONC COPY
A=R0
LC 0010E
A=A-C A
LC 01100
A=A+C A
D1=A
D0= 00420
A=DAT0 A
LC 00030
A=A+C A
D0=A
LC 17
*COPY2
A=DAT1 B
DAT0=A B
D0=D0+ 2
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
C=C-1 B
GONC COPY2

A=R0
LC 0010E
A=A-C A
R0=A
LC 00110
A=A+C A
R1=A
A=A+C A
R2=A
ST=0 0
ST=0 1
ST=0 2
%TESTS-1,2,3%

*LCD2
GOSUBL KERNEL_2
GOSUBL TC_END
GOTO LCD2

*TC_END
?ST=0 0
RTNYES
?ST=0 1
RTNYES
?ST=0 2
RTNYES
C=RSTK
RTN

*C_1
?ST=1 0
RTNYES
A=R0
D0=A
D0=D0- 1
LC 7
*TS_1
A=DAT0 P
?A=0 P
GOYES OK_1
ST=1 0
RTN
*OK_1
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 P
GONC TS_1
A=R0
D0=A
D1= 00420
A=DAT1 A
D1=A
GOSUBL CARRE
A=R0
LC 01100
A=A+C A
D0=A
D1= 00420
A=DAT1 A
LC 00030
A=A+C A
D1=A
GOSUBL CARRE
A=R0
A=A-1 A
R0=A
D0=A
D1= 00420
A=DAT1 A
D1=A
GOSUBL CARRE
A=R0
LC 01100
A=A+C A
D0=A
D1= 00420
A=DAT1 A
LC 00030
A=A+C A
D1=A
GOSUBL CARRE
RTN

*C_2
?ST=1 1
RTNYES
A=R1
D0=A
D0=D0- 1
LC 7
*TS_2
A=DAT0 P
?A=0 P
GOYES OK_2
ST=1 1
RTN
*OK_2
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 P
GONC TS_2
A=R1
D0=A
D1= 00420
A=DAT1 A
A=A+16 A
D1=A
GOSUBL CARRE
A=R1
LC 01100
A=A+C A
D0=A
D1= 00420
A=DAT1 A
LC 00030
A=A+C A
A=A+16 A
D1=A
GOSUBL CARRE
A=R1
A=A-1 A
R1=A
D0=A
D1= 00420
A=DAT1 A
A=A+16 A
D1=A
GOSUBL CARRE
A=R1
LC 01100
A=A+C A
D0=A
D1= 00420
A=DAT1 A
LC 00030
A=A+C A
A=A+16 A
D1=A
GOSUBL CARRE
RTN

*C_3
?ST=1 2
RTNYES
A=R2
D0=A
D0=D0- 1
LC 7
*TS_3
A=DAT0 P
?A=0 P
GOYES OK_3
ST=1 2
RTN
*OK_3
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 P
GONC TS_3
A=R2
D0=A
D1= 00420
A=DAT1 A
A=A+16 A
A=A+16 A
D1=A
GOSUBL CARRE
A=R2
LC 01100
A=A+C A
D0=A
D1= 00420
A=DAT1 A
LC 00030
A=A+C A
A=A+16 A
A=A+16 A
D1=A
GOSUBL CARRE
A=R2
A=A-1 A
R2=A
D0=A
D1= 00420
A=DAT1 A
A=A+16 A
A=A+16 A
D1=A
GOSUBL CARRE
A=R2
LC 01100
A=A+C A
D0=A
D1= 00420
A=DAT1 A
LC 00030
A=A+C A
A=A+16 A
A=A+16 A
D1=A
GOSUBL CARRE
RTN

*CARRE
LC 7
D=C P
*AFB.1'
A=DAT1 B
C=DAT0 B
C=-C-1 B
A=A&C B
DAT0=A B
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 2
D=D-1 P
GONC AFB.1'
RTN

*KERNEL_2
LC 500
D0= 0040A
A=DAT0 X
?AäC X
GOYES GO_2
A=A+1 X
DAT0=A X
RTN
*GO_2
D0= 0040A
A=0 X
DAT0=A X
GOSUBL C_1
GOSUBL C_2
GOSUBL C_3
RTN

*CHECK
GOSUBL TQ
GOSUBL COP_1ç2
%COLONNE%
D0= 00400
A=DAT0 A
LC 00089
A=A+C A
R4=A
LC F
*_H_
R3=C
GOSUBL _V_
GOSUBL _V_
A=R4
A=A+2 A
R4=A
C=R3
C=C-1 P
GONC _H_
%LIGNES%
D0= 00400
A=DAT0 A
LC 00089
A=A+C A
R4=A
LC 6
*_L_
R3=C
GOSUBL _I_
GOSUBL _I_
GOSUBL _I_
GOSUBL _I_
GOSUBL _I_
A=R4
LC 00110
A=A+C A
R4=A
C=R3
C=C-1 P
GONC _L_
GOSUBL çDEL
GOSUBL çSCR
A=R4
LC 7
?A=C P
RTNYES
LC 01000
*PH
C=C-1 A
GONC PH
GOTO CHECK

*_V_
A=R4
R1=A
LC 5
D=C P
*LOOP_1
?D=0 P
RTNYES
D=D-1 P
A=R1
D0=A
GOSUBL ?BLK
?ST=1 0
GOYES Y-BLK
A=R1
LC 00110
A=A+C A
R1=A
GOTO LOOP_1
*Y-BLK
A=R1
D0=A
LC 00110
A=A+C A
D1=A
LC 7
*HOT_ø
RSTK=C
A=DAT0 B
C=DAT1 B
?AãC B
GOYES NO_!
B=A B
AD1EX
LC 00110
A=A+C A
AD1EX
A=DAT1 B
?AãB B
GOYES NO_!
AD1EX
LC 00110
A=A-C A
AD1EX
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
C=RSTK
C=C-1 P
GONC HOT_ø
GOTO YES_!
*NO_!
C=RSTK
A=R1
LC 00110
A=A+C A
R1=A
GOTO LOOP_1
*YES_!
%3-BLOK%
SETDEC
LC 00006
GOSUBL S+3
A=R1
LC 00220
A=A+C A
R2=A
LC 2
B=C P
*_JULIE
A=R2
LC 00110
A=A+C A
R2=A
D1=A
A=R1
D0=A
LC 7
*HOT_2
RSTK=C
A=DAT0 B
C=DAT1 B
?AãC B
GOYES NO_2
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
C=RSTK
C=C-1 P
GONC HOT_2
GOTO YES_2
*NO_2
C=RSTK
GOTO _TO_
*YES_2
SETDEC
LC 00010
GOSUBL S+3
B=B+1 P
?D=0 P
GOYES _TO_
D=D-1 P
GOTO _JULIE
*_TO_
A=B P
R2=A
GOSUBL _DEL
RTN

*?BLK
ST=0 0
LC 7
*_BLK
A=DAT0 B
?A=0 B
GOYES _BL_
ST=1 0
*_BL_
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 P
GONC _BLK
RTN

*çSCR
ST=0 1
D0= 00400
A=DAT0 A
LC 00089
A=A+C A
R2=A
R3=A
P= 0
B=0 P
A=0 P
R4=A
LC 6
D=C P
*_CHIANT_
A=R2
D0=A
GOSUBL ?BLK
?ST=0 0
GOYES Y_SCR
LC D
?BãC P
GOYES _SHADE
A=R4
A=A+1 P
R4=A
GOTO _L.SUIV
*_SHADE
B=B+1 P
A=R2
A=A+2 A
R2=A
GOTO _CHIANT_
*_L.SUIV
B=0 P
A=R3
LC 00110
A=A+C A
R3=A
R2=A
D=D-1 P
GONC _CHIANT_
RTN
*Y_SCR
GOSUBL NOTHING_?
?ST=1 0
GOYES _OK!
A=R4
A=A+1 P
R4=A
GOTO _L.SUIV
*_OK!
LC D
C=C-B P
?C=0 P
GOYES _BLU
C=C-1 P
*_BLU
B=C P
*_14
A=R2
D0=A
D1=A
D1=D1+ 2
LC 7
*_HULT
A=DAT1 B
DAT0=A B
A=0 B
DAT1=A B
RSTK=C
AD0EX
LC 01100
A=A+C A
AD0EX
AD1EX
A=A+C A
AD1EX
A=DAT1 B
DAT0=A B
A=0 B
DAT1=A B
AD0EX
LC 01100
A=A-C A
AD0EX
AD1EX
A=A-C A
AD1EX
C=RSTK
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
C=C-1 P
GONC _HULT
A=R2
A=A+2 A
R2=A
B=B-1 P
GONC _14'
GOTO _L.SUIV
*_14'
GOTO _14

*COP_1ç2
D1= 00400
D0= 00405
A=DAT1 A
C=DAT0 A
D1=A
D0=C
LC 87
*_COP
A=DAT1 W
DAT0=A W
D0=D0+ 16
D1=D1+ 16
C=C-1 B
GONC _COP
RTN

*COP_3ç2
D1= 00411
D0= 00405
A=DAT1 A
C=DAT0 A
D1=A
D0=C
LC 87
*_COP'
A=DAT1 W
DAT0=A W
D0=D0+ 16
D1=D1+ 16
C=C-1 B
GONC _COP'
RTN

*_DEL
A=R1
LC 00880
A=A+C A
D0=A
A=R2
B=A P
*_JULI
A=0 B
LC 7
*CLS
DAT0=A B
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 P
GONC CLS
B=B-1 P
GONC _JULI
A=R1
LC 01100
A=A+C A
D0=A
A=R2
B=A P
*_JULI2
A=0 B
LC 7
*CLS2
DAT0=A B
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 P
GONC CLS2
B=B-1 P
GONC _JULI2
GOSUBL BZZ
RTN

*çDEL
D1= 00405
D0= 00400
A=DAT1 A
C=DAT0 A
D1=A
D0=C
LC 87
*çDEL_
A=DAT1 W
DAT0=A W
D0=D0+ 16
D1=D1+ 16
C=C-1 B
GONC çDEL_
RTN

*_I_
A=R4
R1=A
LC F
D=C P
*LOOP_2
?D=0 P
RTNYES
D=D-1 P
A=R1
D0=A
GOSUBL ?BLK
?ST=1 0
GOYES Y-BLK_2
A=R1
A=A+2 A
R1=A
GOTO LOOP_2
*Y-BLK_2
A=R1
D0=A
A=A+2 A
D1=A
LC 7
*HOT_ø_2
RSTK=C
A=DAT0 B
C=DAT1 B
?AãC B
GOYES NO_!_2
B=A B
D1=D1+ 2
A=DAT1 B
?AãB B
GOYES NO_!_2
D1=D1- 2
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
C=RSTK
C=C-1 P
GONC HOT_ø_2
GOTO YES_!_2
*NO_!_2
C=RSTK
A=R1
A=A+2 A
R1=A
GOTO LOOP_2
*YES_!_2
%3-BLOK%
SETDEC
LC 00006
GOSUBL S+3
A=R1
A=A+4 A
R2=A
LC 2
B=C P
*_JULIE_2
A=R2
A=A+2 A
R2=A
D1=A
A=R1
D0=A
LC 7
*HOT_3
RSTK=C
A=DAT0 B
C=DAT1 B
?AãC B
GOYES NO_3
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 16
D1=D1+ 16
D1=D1+ 2
C=RSTK
C=C-1 P
GONC HOT_3
GOTO YES_3
*NO_3
C=RSTK
GOTO _TO_2
*YES_3
SETDEC
LC 00010
GOSUBL S+3
B=B+1 P
?D=0 P
GOYES _TO_2
D=D-1 P
GOTO _JULIE_2
*_TO_2
A=B P
R2=A
GOSUBL _DEL_2
RTN

*_DEL_2
A=R1
LC 00880
A=A+C A
D0=A
A=R2
B=A P
*_JULI_2
A=0 B
LC 7
*CLS_2
DAT0=A B
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 P
GONC CLS_2
AD0EX
LC 0010E
A=A-C A
AD0EX
B=B-1 P
GONC _JULI_2
A=R1
LC 01100
A=A+C A
D0=A
A=R2
B=A P
*_JULI_3
A=0 B
LC 7
*CLS_3
DAT0=A B
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
C=C-1 P
GONC CLS_3
AD0EX
LC 0010E
A=A-C A
AD0EX
B=B-1 P
GONC _JULI_3
GOSUBL CLAC
RTN

*NOTHING_?
ST=0 0
A=R2
D0=A
A=B P
LC D
C=C-A P
?C=0 P
RTNYES
*_OASIS
A=DAT0 B
?A=0 B
GOYES _OA
ST=1 0
*_OA
D0=D0+ 2
C=C-1 P
GONC _OASIS
RTN

*SCORE
D0= 00411
A=DAT0 A
LC 005B2
A=A+C A
R1=A
D0= 00416
A=DAT0 A
D0= 0041B
DAT0=A A
LC 4
B=C P
GOLONG NB_1

*LEVEL
SETDEC
D0= 00440
A=DAT0 B
B=A B
B=B-1 B
LC 01000
A=C A
*çFIND
?B=0 B
GOYES FINDED
B=B-1 B
C=C+A A
GOTO çFIND
*FINDED
D0= 00416
A=DAT0 A
?A<C A
GOYES NO_L+
D0= 00440
A=DAT0 B
A=A+1 B
DAT0=A B
SETHEX
D0= 00445
A=DAT0 X
LC 100
?AâC X
GOYES NFT
LC 010
A=A-C A
DAT0=A X
*NFT
*NO_L+
SETHEX
D0= 00411
A=DAT0 A
LC 007D2
A=A+C A
R1=A
D0= 00440
A=DAT0 B
D0= 0041B
DAT0=A B
LC 1
B=C P
GOLONG NB_1

*NB_1
GOSUBL _123
D0= 0041B
A=DAT0 P
C=0 P
*TST
?A=C P
GOYES AF_C
C=C+1 P
D1=D1+ 8
GOTO TST
*AF_C
A=R1
D0=A
LC 3
*_AF_S
A=DAT1 B
A=A+A B
A=A+A B
A=A+A B
ABIT=1 0
ABIT=1 1
DAT0=A B
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D1=D1+ 2
C=C-1 P
GONC _AF_S
A=R1
LC 00088
A=A-C A
R1=A
D0= 0041B
A=DAT0 A
ASR A
DAT0=A A
B=B-1 P
GONC NB_1'
RTN
*NB_1'
GOTO NB_1

*_123
GOSUBL _123_
$E011E00090F110003151900011916100C1F04000D1512100E051210001718100A051A0009051E000
*_123_
C=RSTK
D1=C
RTN

*S+3
D0= 00416
A=DAT0 A
A=A+C A
DAT0=A A
SETHEX
RTN


%%%%%%%%%%%%%%%%%%%%%%

*QUIT
GOSUBL CLMEM
D0= 0010C
A=DAT0 P
ABIT=1 3
DAT0=A P
P=      0
A=PC    
LC      00064
C=C+A   A
LA      C0000
?CäA    A
GOYES   FA070
LA      80000
C=C+A   A
*FA070
RSTK=C  
LC      41535
RSTK=C  
LC      E223
RSTK=C  
LC      1535
RSTK=C  
LC      7CA83
RSTK=C  
LA      80000
D0=     0000A
C=DAT0  A
B=C     A
C=0     A
GOVLNG  4049B
D0=     80092
A=DAT0  7
D0=     0F
DAT0=A  7
D0=     0011A
C=0     P
DAT0=C  P
D0=     00110
DAT0=C  P
GOSBVL  010E5
INTON
GOSBVL  00D57
LC      7
D0=     00128
DAT0=C  P
GOSBVL  01C7F
GOSBVL  067D2
?ST=1   2
GOYES   FA137
A=DAT0  A
D0=D0+  5
PC=(A)  
*FA137
A=DAT0  A
D0=D0+  5
PC=(A)


*BAA05
LC      80000
A=C     A
C=RSTK  
C=C+A   A
RSTK=C  
LC      09B4D
RSTK=C  
LC      C0000
B=C     A
LC      66B75
RSTK=C  
C=0     A
GOVLNG  4049B

*INITIATION
D0= 0010C
A=DAT0 P
ABIT=0 3
DAT0=A P
LC F
D0= 00128
DAT0=C P
CLRST
%VAR%
A=0 W
D0= 0040A
DAT0=A 7
%80210=POS_0ç3%
A=0 A
D0= 00416 %SCORE%
DAT0=A A
D0= 00440
LA 01
DAT0=A B  %LEVEL%
LC 400
D0= 00445
DAT0=C X %SPEED%
RTN

*INI_GREY
GOSUBL PRE
$FFF1200EF70000000000000000000CFF30FFF120CFFF10000000CFF00000000CFF70FFF000FF3830000008FFF300000008FF7000E000F10E3000000EF707000000083000006070C3FF100FF30E30C7000FF30030004A28900FF300EFFF087EF300EFFF00AF104C2C11087008FF1C10EF7008FF1C10A2104AEC39100008F00F100F0008F00F10A1104C2CF1000000E9FF00000000E9FF00A2104A28F00000008FF1000000008FF100A1104C20700000000C30000000000C3000A2104A2000000000000000000000000000A1104C2000000000000000000000000000A2104A2020000000000000000000000000A1104C2020000000000000000000000000A2104A200FF3000008F18F1000000E3000A1104C208FF7000008F1CF1000000E3000A2104A208FFF00000CF1CF0000000E1000A1104C208FFF00000CF1EF000000000000A2104A20C78F1F800CF1FF8FF0C33F0EF0A1104C20C70F9FE10EF9F7CFF1EFBF0FF1A2104A20C30F9FF00EF9F7CFF1EFBFCFF3A1104C20E30F8FF00EFDD7C0F1FF9FE7E3A2104A20E38FCF000FFFF300F1F1C7E1E3A1104C20E18FC7000FEFE38FF1F0C7F1E3A2104A20F187C3000FE7E3EFF9F0C7F1E3A1104C20F1C7E3008FC3F1FFF8F0EBF0E3A2104A20F0E3E30087C3F9F8F870EBF0F1A1104C28F8F1E10087C1F9F8FC70EBF0F1A2104A28FFF0F100C708FC7C7C70F9F8F0A1104C28FF70F100C308FCFF7C30F9FF70A2104A2CFF10F000C308F8FD7E30F1FF30A1104C2CF300F000C10878FC3E10F0EF00A2104A2000000000000000000000000000A1104C2000000000000000000000000000A2104A2000000000000000000000000000A1104C2000000000000000000000000000A2104A20000EF100CF3000FF000EF10000A1104C20000A010041200058000A010000A2104A20000A010041200058000A01E000A1104C20000CF0008F1000E7000CF0E000A210CF20000850000B0000C20008504200AF10EF70050850000B0000C2000850B100FF7000E0505850000B0000C2000858A008300000E0050850000B0000C2000850E008300000E1525CF0008F1000E7000CF0A00C3000FFF1421CF0008F1000E7000CF0B10CFF70FFFFFFFFFF7EFFFFCFFFF9FFFFFFFFFF70FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70F70CFFFFFFFF70CFFF10FFFFFFFFF10F70F100FFFFFFFF100FF700CFFFFFFF700C70F000EFFFFFFF000EF3008FFFFFFF3008707000CFFFFFF7000CF1000FFFFFFF10007030008FFFFFF30008F0000EFFFFFF00006030008FFFFFF30008F0000EFFFFFF00006010000FFFFFF1000070000CFFFFF700004099273F8E8AF188307AEACC3272E7757740D5155FAEAAF1C8207A2A2C7BABE7552240D5155F8E8DF1883076E4EC7B2AE7552240D5155FEEADF188007A248C7BABE755224099275FE8ADF1C9007AE46C3AA3E777724010000FFFFFF1000070000CFFFFF7400040FFF10000000000000000000000000CFF70FFF10800000000000000000000000CFF70FFF10400000000000000000000000CFF70FFF17000000000000000000000000CFF70FF7C81000000000000000000000000FF7030340100000000000000000000000060603032020000000000000000000000006060303202000000000000000000000000606030320200000000000000000000000060603034010000000000000000000000006060303C8100000000000000000000000060603030740000000000000000000000006060303108000000000000000000000000606030B0000000000000000000000000006060303000000000000000000000000000606030308FF100000CF0CF0000000F100060603030CFF300000CF0EF0000000F100060603030CFF700000EF0E70000000F000060603030EFF700000EF0F700000000000060603030E3CF87400EF8F7CF70E9970F7060603030E38FC7F00FFCF3EFF0FFD78FF060603030E18FCF700FFCF3EFF0FFD7EFF160603030F187CF700FFEE368F8FFC7F3F160603030F1C7E7008FFFF108F8F0E3F0F160603030F0C7E30087F7F1CFF870EBF0F160603038F0C3E10087F3F1FFFC70EBF0F160603038F0E3F100C7E9F8FF7C70FD70F16060303870F1F100C3E9FC7C7C30FD78F06060303C7CF0F000C3E8FC7C7E30FD78F06060303CFF78F000E30C7E3E3E38FC7C706060303CFF38F000E10C7EFF3E18FCFF306060303EFF087000E10C7CFE3F18F8FF106060303EF1087000E00C3C7E1F0870F700606030300000000000000000000000000060603030000000000000000000000000006060303000000000000000000000000000606030300000000000000000000000000060603030000EF100CF3000FF000EF10000606030300002F1004E30009F0002F10000606030300002F1004E30009F0002F1E00060603030000CF0008F1000E7000CF0E00060603030000860000D000043000860420060601060020860000D000043000860F1003040FFF0252860000D000043000868E008FF70FFF0525860000D000043000860E008FF70FFF1222CF0008F1000E7000CF0A00CFF70FFF1421CF0008F1000E7000CF0B10CFF70FFF10000000000000000000000000CFF70FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70F70CFFF10FFFFFFFFFFFFFF70CFFF10F70F100FF700CFFFFFFFFFFFFF100FF700C70F000EF3008FFFFFFFFFFFFF000EF3008707000CF1000FFFFFFFFFFFF7000CF10007030008F0000EFFFFFFFFFFF30008F00006030008F0000EFFFFFFFFFFF30008F0000601000070000CFFFFFFFFFFF1000070000409927370000CF77CFF5153F100007757740D515570000CF37DFF5D5DF100007552240D515570000CF77CFF91B1F100007552240D515570000CF77FFF5DB7F1000075522409927570000CF36FFF51B9F1000077772401000070000CFFFFFFFFFFF100007400040
*PRE
C=RSTK
D1=C
D0= 00400
A=DAT0 A
D0=A
GOSUB _GG
D0= 00411
A=DAT0 A
D0=A
GOLONG _GG

*_GG
LC 87
*A_GR
A=DAT1 W
DAT0=A W
D0=D0+ 16
D1=D1+ 16
C=C-1 B
GONC A_GR
RTN

*C-
D0= 00101
A=DAT0 B
D1= 80435
DAT1=A B
*C--
?A=0 B
GOYES FC-
A=A-1 B
DAT0=A B
LC F00
*-C
C=C-1 X
GONC -C
GOTO C--
*FC-
RTN

*C+
D0= 00101
A=DAT0 B
D1= 00435
C=DAT1 B
B=C B
*C++
?A=B B
GOYES FC+
A=A+1 B
DAT0=A B
LC F00
*+C
C=C-1 X
GONC +C
GOTO C++
*FC+
RTN

'HI
'CLAC
'BZZ
*CLIC
LC 800
OUT=C
C=0 X
OUT=C
RTN


@